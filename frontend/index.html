<!doctype html>
<html lang="en">
<head>
  <!-- Prevent favicon 404 -->
  <link rel="icon" href="data:,">
  <meta charset="utf-8" />
  <title>Smart Document Finder</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Top bar with brand on the right -->
  <div class="topbar">
    <div class="container topbar-inner">
      <div class="topbar-left"></div>
      <div class="topbar-right">
        <!-- Put your logo at /frontend/assets/image.png -->
        <img src="assets/image.png" alt="Western Heat and Forge Pvt Ltd." class="brand-logo" />
        <span class="brand-name">Western Heat and Forge Pvt Ltd.</span>
      </div>
    </div>
  </div>

  <!-- Centered header -->
  <header class="container hero">
    <div>
      <h1>Smart Document Finder</h1>
      <p class="subtitle">Filename-only search with optional Year, Month, and Company filters.</p>
    </div>
  </header>

  <!-- Search card -->
  <section class="container card">
    <div class="filters">
      <div class="field">
        <label for="year">Year</label>
        <select id="year">
          <option value="">Any</option>
          <option value="2020">2020</option>
          <option value="2021">2021</option>
          <option value="2022">2022</option>
          <option value="2023">2023</option>
          <option value="2024">2024</option>
          <option value="2025">2025</option>
          <option value="2026">2026</option>
          <option value="2027">2027</option>
          <option value="2028">2028</option>
          <option value="2029">2029</option>
          <option value="2030">2030</option>
          <option value="2031">2031</option>
          <option value="2032">2032</option>
          <option value="2033">2033</option>
          <option value="2034">2034</option>
          <option value="2035">2035</option>
          <option value="2036">2036</option>
          <option value="2037">2037</option>
          <option value="2038">2038</option>
          <option value="2039">2039</option>
          <option value="2040">2040</option>
          <option value="2041">2041</option>
          <option value="2042">2042</option>
          <option value="2043">2043</option>
          <option value="2044">2044</option>
          <option value="2045">2045</option>
          <option value="2046">2046</option>
          <option value="2047">2047</option>
          <option value="2048">2048</option>
          <option value="2049">2049</option>
          <option value="2050">2050</option>
        </select>
      </div>

      <div class="field">
        <label for="month">Month</label>
        <select id="month">
          <option value="">Any</option>
          <option>January</option><option>February</option><option>March</option>
          <option>April</option><option>May</option><option>June</option>
          <option>July</option><option>August</option><option>September</option>
          <option>October</option><option>November</option><option>December</option>
        </select>
      </div>

      <div class="field grow">
        <label for="company">Folder name </label>
        <input id="company" type="text" placeholder="e.g., Cameron, AVK, etc." />
      </div>
    </div>

    <div class="search-row">
      <!-- EXP prefix fixed + input -->
      <div class="exp-input-wrap">
        <span class="exp-prefix">EXP-</span>
        <input
          id="query"
          class="search-input"
          type="text"
          inputmode="numeric"
          placeholder="Enter number (e.g., 192)"
          autocomplete="off"
        />
      </div>
      <button id="btnSearch" class="btn primary">Search</button>
      <button id="btnClear" class="btn">Clear</button>
      <!-- Monthly data button -->
      <button id="btnMonthly" class="btn" title="List all documents for selected Year + Month">Monthly Data</button>

      <!-- Status filter -->
      <select id="statusFilter" class="filter-select" aria-label="Status filter" title="Filter by status">
        <option value="">All</option>
        <option value="found">Found</option>
        <option value="missing">Missing</option>
      </select>
    </div>

    <div id="status" class="status" aria-live="polite"></div>

    <!-- Single Results table (always 7 parent rows) -->
    <div class="table-wrap">
      <table id="results" class="table">
        <thead>
          <tr>
            <th>Folder</th>
            <th>Status</th>
            <th>Count</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="parentRows">
          <!-- 7 rows rendered here in fixed order -->
        </tbody>
      </table>

      <div id="empty" class="empty hidden">
        <div class="empty-icon">üîé</div>
        <div class="empty-text">Start by typing a document like <strong>EXP-192</strong> and click Search.</div>
      </div>
    </div>
  </section>

  <!-- Monthly coverage (Available vs Missing) -->
  <section id="monthlyCard" class="container card hidden" aria-live="polite">
    <h2 style="margin-top:0;">Monthly Coverage</h2>
    <div id="monthlyStatus" class="status"></div>

    <div class="table-wrap" id="monthlyWrap" style="margin-top:8px;">
      <!-- Available table -->
      <h3 style="margin: 10px 0 6px;">Available</h3>
      <table id="availTable" class="table">
        <thead>
          <tr>
            <th>Folder</th>
            <th>Count</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="availBody"></tbody>
      </table>

      <!-- Missing list -->
      <h3 style="margin: 16px 0 6px;">Missing</h3>
      <div id="missingWrap" class="empty hidden">
        <div class="empty-icon">üóÇÔ∏è</div>
        <div class="empty-text">All folders have documents for this period.</div>
      </div>
      <div id="missingBadges" style="display:flex;flex-wrap:wrap;gap:8px;"></div>
    </div>
  </section>

  <!-- Multi-EXP Missing Report -->
  <section id="batchCard" class="container card" aria-live="polite">
    <h2 style="margin-top:0;">Multi-EXP Missing Report</h2>
    <p class="subtitle" style="margin-top:4px;">
      Add up to 30 EXP numbers, then use your current Year / Month / Company filters to summarise missing folders.
    </p>

    <div class="search-row" style="gap:10px; align-items:center;">
      <div class="exp-input-wrap" style="max-width:320px;">
        <span class="exp-prefix">EXP-</span>
        <input
          id="batchExpInput"
          class="search-input"
          type="text"
          inputmode="numeric"
          placeholder="e.g., 123"
          autocomplete="off"
        />
      </div>

      <button id="btnAddExp" class="btn">Save</button>
      <span id="batchCounter" class="status" style="margin:0;">0 / 30 saved</span>

      <div style="flex:1;"></div>

      <button id="btnViewMissing" class="btn">View Missing</button>
      <button id="btnExportDocx" class="btn">Export .DOCX</button>
      <!-- ‚úÖ NEW: Clear all saved EXPs -->
      <button id="btnClearExp" class="btn" title="Clear all saved EXP numbers">Clear</button>
    </div>

    <!-- Saved EXP chips -->
    <div id="expChipList" style="display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;"></div>

    <div id="batchStatus" class="status" aria-live="polite"></div>

    <!-- Results -->
    <div class="table-wrap" style="margin-top:8px;">
      <table id="batchResults" class="table">
        <thead>
          <tr>
            <th style="width:180px;">EXP</th>
            <th>Missing Folders</th>
          </tr>
        </thead>
        <tbody id="batchBody"></tbody>
      </table>

      <div id="batchEmpty" class="empty">
        <div class="empty-icon">üìÑ</div>
        <div class="empty-text">Add EXP numbers and click <strong>View Missing</strong> to see a summary here.</div>
      </div>
    </div>
  </section>

  <!-- Only the external script -->
  <script src="app.js?v=32"></script>
</body>
</html>
